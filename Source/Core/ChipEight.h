#pragma once


struct ChipEight
{
    static constexpr unsigned short kMemorySize = 0xfff;
    static constexpr unsigned short kProgramStart = 0x200;
    static constexpr unsigned short kProgramStartETI660 = 0x600;

    ChipEight() = default;

    void Initialize();
    bool LoadProgram(const char* inPath);

    void EmulateCycle();
    
    // opcode
    unsigned short OpCode = 0;

    // Memory
    unsigned char Data[kMemorySize];

    // V
    unsigned char Registers[16];

    // Index Register
    unsigned short RegisterIndex = 0;

    // Program Counter
    unsigned short ProgramCounter = 0x200;

    // GFX
    unsigned char GfxBuffer[64 * 32];

    // Timers
    unsigned char DelayTimer = 0;
    unsigned char SoundTimer = 0;

    // Stack
    unsigned short Stack[16];
    unsigned short StackPointer = 0;

    // Keys
    unsigned char Key[16];

    // Font
    unsigned char Font[80] =
    {
      0xF0, 0x90, 0x90, 0x90, 0xF0, // 0
      0x20, 0x60, 0x20, 0x20, 0x70, // 1
      0xF0, 0x10, 0xF0, 0x80, 0xF0, // 2
      0xF0, 0x10, 0xF0, 0x10, 0xF0, // 3
      0x90, 0x90, 0xF0, 0x10, 0x10, // 4
      0xF0, 0x80, 0xF0, 0x10, 0xF0, // 5
      0xF0, 0x80, 0xF0, 0x90, 0xF0, // 6
      0xF0, 0x10, 0x20, 0x40, 0x40, // 7
      0xF0, 0x90, 0xF0, 0x90, 0xF0, // 8
      0xF0, 0x90, 0xF0, 0x10, 0xF0, // 9
      0xF0, 0x90, 0xF0, 0x90, 0x90, // A
      0xE0, 0x90, 0xE0, 0x90, 0xE0, // B
      0xF0, 0x80, 0x80, 0x80, 0xF0, // C
      0xE0, 0x90, 0x90, 0x90, 0xE0, // D
      0xF0, 0x80, 0xF0, 0x80, 0xF0, // E
      0xF0, 0x80, 0xF0, 0x80, 0x80  // F
    };
};